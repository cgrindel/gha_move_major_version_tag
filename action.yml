name: 'Move a Major Version Tag'
description: 'Move a major version tag (e.g. v1) after a release.'

inputs:
  release_tag:
    required: true
    type: string

runs:
  using: composite
  steps:
    - uses: actions/checkout@v2
      with:
        repository: cgrindel/gha_move_major_version_tag
        # FIX ME
        ref: debug_other_repo_using_action
        path: gha_move_major_version_tag

    - name: DEBUG
      shell: bash
      run: |
        set -x
        echo "GITHUB_WORKSPACE: ${GITHUB_WORKSPACE:-}"
        echo "PWD: ${PWD}"
        cat README.md
        tree

    - name: Move the major version tag
      shell: bash
      env:
        RELEASE_TAG: ${{ inputs.release_tag }}
      run: |
        bazelisk run //:move_major_version_tag -- \
          --release_tag "${RELEASE_TAG}" \
          --repo_dir "${PWD}"
